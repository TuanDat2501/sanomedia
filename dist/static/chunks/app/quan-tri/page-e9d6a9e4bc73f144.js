(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1298],{44353:function(e,t,n){Promise.resolve().then(n.bind(n,63849))},63849:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var s=n(57437),a=n(2265),i=n(57818),l=n(38472);n(18416);let r=(0,i.default)(()=>Promise.all([n.e(3070),n.e(8436)]).then(n.t.bind(n,98436,23)),{loadableGenerated:{webpack:()=>[98436]},ssr:!1});function d(){let[e,t]=(0,a.useState)({title:"",description:"",thumbnail:"",content:"",isPinned:!1}),[n,i]=(0,a.useState)([]),[d,o]=(0,a.useState)(!1),[c,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{let e=await l.Z.get("/api/blog");e.data.success&&i(e.data.data)}catch(e){console.error("Lỗi lấy danh s\xe1ch:",e)}},m=e=>{let{name:n,value:s}=e.target;t(e=>({...e,[n]:s}))},u=async t=>{t.preventDefault(),o(!0);try{c?(await l.Z.put("/api/blog",e)).data.success&&(alert("✅ Cập nhật b\xe0i viết th\xe0nh c\xf4ng!"),p(),b()):(await l.Z.post("/api/blog",e)).data.success&&(alert("✅ Đăng b\xe0i th\xe0nh c\xf4ng!"),p(),b())}catch(e){var n,s;console.error(e),alert("❌ Lỗi: "+((null===(s=e.response)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.error)||"Unknown error"))}finally{o(!1)}},x=async t=>{if(confirm("Bạn c\xf3 chắc chắn muốn xo\xe1 b\xe0i viết n\xe0y kh\xf4ng? H\xe0nh động n\xe0y kh\xf4ng thể phục hồi!"))try{await l.Z.delete("/api/blog?id=".concat(t)),alert("\uD83D\uDDD1️ Đ\xe3 xo\xe1 b\xe0i viết!"),b(),c&&e._id===t&&p()}catch(e){alert("❌ Lỗi khi xo\xe1 b\xe0i!")}},g=e=>{t({_id:e._id,title:e.title,description:e.description,thumbnail:e.thumbnail||"",content:e.content,isPinned:e.isPinned||!1}),h(!0),window.scrollTo({top:0,behavior:"smooth"})},p=()=>{t({title:"",description:"",thumbnail:"",content:"",isPinned:!1}),h(!1)};return(0,s.jsxs)("div",{className:"max-w-5xl mx-auto p-8 bg-gray-50 min-h-screen",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md mb-12 border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:c?"✏️ Chỉnh sửa b\xe0i viết":"\uD83D\uDCDD Đăng b\xe0i mới"}),c&&(0,s.jsx)("button",{onClick:p,className:"text-sm text-red-600 hover:underline",children:"Hủy bỏ & Tạo mới"})]}),(0,s.jsxs)("form",{onSubmit:u,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium text-gray-700 mb-1",children:"Ti\xeau đề"}),(0,s.jsx)("input",{type:"text",name:"title",value:e.title,onChange:m,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium text-gray-700 mb-1",children:"M\xf4 tả ngắn"}),(0,s.jsx)("textarea",{name:"description",value:e.description,onChange:m,className:"w-full border border-gray-300 p-2 rounded h-24 focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium text-gray-700 mb-1",children:"Link Thumbnail"}),(0,s.jsx)("input",{type:"text",name:"thumbnail",value:e.thumbnail,onChange:m,placeholder:"https://...",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none mb-2"}),e.thumbnail&&(0,s.jsx)("img",{src:e.thumbnail,alt:"Preview",className:"h-12 w-auto object-cover rounded border"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block font-medium text-gray-700 mb-2",children:"Nội dung b\xe0i viết"}),(0,s.jsx)("div",{className:"bg-white border border-gray-300 rounded overflow-hidden",children:(0,s.jsx)(r,{theme:"snow",value:e.content,onChange:e=>{t(t=>({...t,content:e}))},modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image"],["clean"]]},className:"h-64 mb-12"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 bg-gray-50 p-4 rounded border border-gray-100",children:[(0,s.jsx)("input",{type:"checkbox",id:"isPinned",name:"isPinned",checked:e.isPinned,onChange:e=>{t(t=>({...t,[e.target.name]:e.target.checked}))},className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer"}),(0,s.jsx)("label",{htmlFor:"isPinned",className:"font-medium text-gray-700 cursor-pointer select-none",children:"Ghim b\xe0i viết n\xe0y l\xean đầu"})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{type:"submit",disabled:d,className:"flex-1 text-white px-6 py-3 rounded font-bold transition-colors ".concat(c?"bg-orange-500 hover:bg-orange-600":"bg-blue-600 hover:bg-blue-700"," disabled:bg-gray-400"),children:d?"Đang xử l\xfd...":c?"Lưu thay đổi":"Đăng b\xe0i ngay"}),c&&(0,s.jsx)("button",{type:"button",onClick:p,className:"px-6 py-3 rounded bg-gray-200 text-gray-700 font-bold hover:bg-gray-300",children:"Hủy"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:["Danh s\xe1ch b\xe0i viết (",n.length,")"]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100 border-b",children:[(0,s.jsx)("th",{className:"p-3 font-semibold text-gray-600 text-sm",children:"H\xecnh ảnh"}),(0,s.jsx)("th",{className:"p-3 font-semibold text-gray-600 text-sm",children:"Ti\xeau đề"}),(0,s.jsx)("th",{className:"p-3 font-semibold text-gray-600 text-sm",children:"Ng\xe0y đăng"}),(0,s.jsx)("th",{className:"p-3 font-semibold text-gray-600 text-sm text-right",children:"H\xe0nh động"})]})}),(0,s.jsxs)("tbody",{children:[n.map(e=>(0,s.jsxs)("tr",{className:"border-b hover:bg-gray-50 group",children:[(0,s.jsx)("td",{className:"p-3 w-20",children:e.thumbnail?(0,s.jsx)("img",{src:e.thumbnail,className:"w-12 h-12 object-cover rounded border"}):(0,s.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded"})}),(0,s.jsxs)("td",{className:"p-3",children:[(0,s.jsx)("div",{className:"font-medium text-gray-800 line-clamp-1",children:e.title}),e.isPinned&&(0,s.jsx)("span",{className:"text-[10px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded font-bold",children:"Ghim"})]}),(0,s.jsx)("td",{className:"p-3 text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("vi-VN")}),(0,s.jsxs)("td",{className:"p-3 text-right",children:[(0,s.jsx)("button",{onClick:()=>g(e),className:"text-blue-600 hover:underline mr-4 font-medium text-sm",children:"Sửa"}),(0,s.jsx)("button",{onClick:()=>x(e._id),className:"text-red-500 hover:underline font-medium text-sm",children:"Xo\xe1"})]})]},e._id)),0===n.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"p-8 text-center text-gray-500",children:"Chưa c\xf3 b\xe0i viết n\xe0o. H\xe3y đăng b\xe0i đầu ti\xean!"})})]})]})})]})]})}}},function(e){e.O(0,[7325,9141,2971,7023,1744],function(){return e(e.s=44353)}),_N_E=e.O()}]);